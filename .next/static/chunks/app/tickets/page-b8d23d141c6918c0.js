(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[512],{1592:(e,t,a)=>{Promise.resolve().then(a.bind(a,9615))},8430:(e,t,a)=>{"use strict";a.d(t,{EZ:()=>r,ZC:()=>o,ey:()=>i,hn:()=>n,oP:()=>l});let s="http://localhost:3001";async function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.status&&t.append("status",e.status),e.priority&&t.append("priority",e.priority),e.email&&t.append("email",e.email),e.assigned_to&&t.append("assigned_to",e.assigned_to),e.page&&t.append("page",e.page),e.limit&&t.append("limit",e.limit||"10");let a="".concat(s,"/api/tickets").concat(t.toString()?"?"+t.toString():"");try{let e=await fetch(a,{cache:"no-store",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to fetch tickets");return e.json()}catch(e){return console.error("Error fetching tickets:",e),{data:[],pagination:{page:1,pages:1,total:0,limit:10}}}}async function n(e){try{let t=await fetch("".concat(s,"/api/tickets/").concat(e),{cache:"no-store",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch ticket");return t.json()}catch(e){throw console.error("Error fetching ticket:",e),e}}async function r(e,t){try{let a=await fetch("".concat(s,"/api/tickets/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to update ticket");return a.json()}catch(e){throw console.error("Error updating ticket:",e),e}}async function o(e,t){try{let a=await fetch("".concat(s,"/api/tickets/").concat(e,"/reply"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(!a.ok)throw Error("Failed to send reply");return a.json()}catch(e){throw console.error("Error sending reply:",e),e}}async function i(){try{let e=await fetch("".concat(s,"/api/assignments/eligible-agents"),{cache:"no-store",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to fetch agents");return e.json()}catch(e){return console.error("Error fetching agents:",e),{agents:[]}}}},9615:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),l=a(2115),n=a(2619),r=a.n(n),o=a(8430);function i(){let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)([]),[i,x]=(0,l.useState)({page:1,pages:1,total:0}),[g,p]=(0,l.useState)(!0),[h,m]=(0,l.useState)({status:"",priority:"",assigned_to:"",page:1});async function u(){p(!0);try{var e,a,s,l,n,r,i;let c=await (0,o.oP)(h);console.log("\uD83D\uDCCA Tickets API Response:",c),console.log("\uD83C\uDFAB First Ticket Sample:",null==(e=c.data)?void 0:e[0]),console.log("\uD83D\uDC64 Agent Info Check:",{assigned_agent_name:null==(s=c.data)||null==(a=s[0])?void 0:a.assigned_agent_name,assigned_agent_email:null==(n=c.data)||null==(l=n[0])?void 0:l.assigned_agent_email,assigned_to:null==(i=c.data)||null==(r=i[0])?void 0:r.assigned_to}),t(c.data||[]),x(c.pagination||{page:1,pages:1,total:0})}catch(e){console.error("âŒ Error loading tickets:",e)}finally{p(!1)}}async function u(){p(!0);try{var e,a,s,l,n,r,i;let c=await (0,o.oP)(h);console.log("\uD83D\uDCCA Tickets API Response:",c),console.log("\uD83C\uDFAB First Ticket Sample:",null==(e=c.data)?void 0:e[0]),console.log("\uD83D\uDC64 Agent Info Check:",{assigned_agent_name:null==(s=c.data)||null==(a=s[0])?void 0:a.assigned_agent_name,assigned_agent_email:null==(n=c.data)||null==(l=n[0])?void 0:l.assigned_agent_email,assigned_to:null==(i=c.data)||null==(r=i[0])?void 0:r.assigned_to}),t(c.data||[]),x(c.pagination||{page:1,pages:1,total:0})}catch(e){console.error("âŒ Error loading tickets:",e)}finally{p(!1)}}async function y(){try{let e=await (0,o.ey)();n(e.agents||[])}catch(e){console.error("Error loading agents:",e)}}function b(e,t){m(a=>({...a,[e]:t,page:1}))}function f(e){m(t=>({...t,page:e}))}return(0,l.useEffect)(()=>{u()},[h]),(0,l.useEffect)(()=>{y()},[]),(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-yellow-400/20 to-yellow-600/20 rounded-3xl blur-xl"}),(0,s.jsx)("div",{className:"relative bg-gradient-to-br from-gray-900/90 to-gray-900/50 backdrop-blur-sm border border-gray-800/50 rounded-2xl p-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center shadow-lg shadow-yellow-400/30",children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFAB"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-white tracking-tight",children:["Support ",(0,s.jsx)("span",{className:"gradient-text",children:"Tickets"})]}),(0,s.jsx)("p",{className:"text-gray-400 text-lg mt-1",children:"Manage customer support requests"})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Total Tickets"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-white",children:i.total})]})]})})]}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-gray-900/80 to-gray-900/40 backdrop-blur-sm border border-gray-800/50 rounded-2xl p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"\uD83D\uDCCA Status"}),(0,s.jsxs)("select",{value:h.status,onChange:e=>b("status",e.target.value),className:"w-full px-4 py-3 bg-gray-800/60 border border-gray-700/50 rounded-xl text-white focus:outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20 transition-all",children:[(0,s.jsx)("option",{value:"",children:"All Status"}),(0,s.jsx)("option",{value:"open",children:"Open"}),(0,s.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,s.jsx)("option",{value:"resolved",children:"Resolved"}),(0,s.jsx)("option",{value:"closed",children:"Closed"})]})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"\uD83D\uDD25 Priority"}),(0,s.jsxs)("select",{value:h.priority,onChange:e=>b("priority",e.target.value),className:"w-full px-4 py-3 bg-gray-800/60 border border-gray-700/50 rounded-xl text-white focus:outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20 transition-all",children:[(0,s.jsx)("option",{value:"",children:"All Priority"}),(0,s.jsx)("option",{value:"urgent",children:"Urgent"}),(0,s.jsx)("option",{value:"high",children:"High"}),(0,s.jsx)("option",{value:"medium",children:"Medium"}),(0,s.jsx)("option",{value:"low",children:"Low"})]})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"\uD83D\uDC64 Assigned To"}),(0,s.jsxs)("select",{value:h.assigned_to,onChange:e=>b("assigned_to",e.target.value),className:"w-full px-4 py-3 bg-gray-800/60 border border-gray-700/50 rounded-xl text-white focus:outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20 transition-all",children:[(0,s.jsx)("option",{value:"",children:"All Agents"}),(0,s.jsx)("option",{value:"unassigned",children:"Unassigned"}),a.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.full_name," (",e.role,")"]},e.id))]})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsx)("button",{onClick:()=>m({status:"",priority:"",assigned_to:"",page:1}),className:"px-6 py-3 bg-gray-700/60 hover:bg-gray-600/60 text-white font-semibold rounded-xl transition-all duration-200",children:"Reset Filters"})})]})}),(0,s.jsxs)("div",{className:"bg-gradient-to-br from-gray-900/80 to-gray-900/40 backdrop-blur-sm border border-gray-800/50 rounded-2xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-5 border-b border-gray-800/50",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Tickets List"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:g?"Loading...":"Showing ".concat(e.length," of ").concat(i.total," tickets")})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:g?(0,s.jsx)("div",{className:"p-6",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"shimmer h-16 rounded-xl mb-3"},t))}):(0,s.jsxs)("table",{className:"w-full min-w-max",children:[(0,s.jsx)("thead",{className:"bg-gray-800/60",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Ticket ID"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Customer"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Subject"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Priority"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Assigned To"}),(0,s.jsx)("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-300 uppercase tracking-wider whitespace-nowrap",children:"Created"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-800/50",children:0===e.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-400",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-4xl mb-2",children:"\uD83D\uDCED"}),(0,s.jsx)("p",{children:"No tickets found"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Try adjusting your filters or check back later"})]})})}):e.map(e=>(console.log("\uD83C\uDFAB Ticket ".concat(e.ticket_id,":"),{assigned_agent_name:e.assigned_agent_name,assigned_agent_email:e.assigned_agent_email,assigned_to:e.assigned_to,all_fields:Object.keys(e)}),(0,s.jsxs)("tr",{className:"hover:bg-gray-800/30 transition-all duration-200",children:[(0,s.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,s.jsx)(r(),{href:"/tickets/".concat(e.ticket_id),className:"text-yellow-400 hover:text-yellow-300 font-mono text-sm font-semibold transition-colors",children:e.ticket_id})}),(0,s.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-white font-medium max-w-[150px] truncate",children:e.email})}),(0,s.jsx)("td",{className:"px-4 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-300 max-w-[200px] truncate",children:e.subject})}),(0,s.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,s.jsx)(c,{status:e.status})}),(0,s.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,s.jsx)(d,{priority:e.priority})}),(0,s.jsx)("td",{className:"px-4 py-4",children:e.assigned_agent_name?(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-[200px]",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-black font-bold text-xs flex-shrink-0",children:e.assigned_agent_name.split(" ").map(e=>e[0]).join("").toUpperCase()}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-white truncate",children:e.assigned_agent_name}),(0,s.jsx)("div",{className:"text-xs text-gray-400 truncate",children:e.assigned_agent_email})]})]}):(0,s.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Unassigned"})}),(0,s.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-300 font-medium",children:new Date(e.created_at).toLocaleDateString()})]},e.ticket_id)))})]})}),i.pages>1&&(0,s.jsxs)("div",{className:"px-6 py-5 border-t border-gray-800/50 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-400 font-medium",children:["Page ",(0,s.jsx)("span",{className:"text-white font-semibold",children:i.page})," of"," ",(0,s.jsx)("span",{className:"text-white font-semibold",children:i.pages})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>f(i.page-1),disabled:i.page<=1,className:"px-4 py-2 bg-gray-800/60 text-white rounded-xl hover:bg-gray-700/60 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-semibold",children:"Previous"}),[...Array(Math.min(5,i.pages))].map((e,t)=>{let a=t+1;return(0,s.jsx)("button",{onClick:()=>f(a),className:"px-4 py-2 rounded-xl font-semibold transition-all ".concat(a===i.page?"bg-gradient-to-r from-yellow-400 to-yellow-500 text-black shadow-lg shadow-yellow-400/30":"bg-gray-800/60 text-white hover:bg-gray-700/60"),children:a},a)}),(0,s.jsx)("button",{onClick:()=>f(i.page+1),disabled:i.page>=i.pages,className:"px-4 py-2 bg-gray-800/60 text-white rounded-xl hover:bg-gray-700/60 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-semibold",children:"Next"})]})]})]})]})}function c(e){let{status:t}=e,a={open:{bg:"bg-blue-500/20",text:"text-blue-400",label:"Open"},in_progress:{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"In Progress"},resolved:{bg:"bg-green-500/20",text:"text-green-400",label:"Resolved"},closed:{bg:"bg-gray-500/20",text:"text-gray-400",label:"Closed"}},{bg:l,text:n,label:r}=a[t]||a.open;return(0,s.jsx)("span",{className:"inline-flex px-3 py-1 rounded-lg text-xs font-bold ".concat(l," ").concat(n),children:r})}function d(e){let{priority:t}=e,a={urgent:{bg:"bg-red-500/20",text:"text-red-400",icon:"\uD83D\uDD34"},high:{bg:"bg-orange-500/20",text:"text-orange-400",icon:"\uD83D\uDFE0"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",icon:"\uD83D\uDFE1"},low:{bg:"bg-green-500/20",text:"text-green-400",icon:"\uD83D\uDFE2"}},{bg:l,text:n,icon:r}=a[t]||a.medium;return(0,s.jsxs)("span",{className:"inline-flex items-center space-x-1 px-3 py-1 rounded-lg text-xs font-bold ".concat(l," ").concat(n),children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)("span",{children:null==t?void 0:t.toUpperCase()})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=1592)),_N_E=e.O()}]);